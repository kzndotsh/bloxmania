!function(){"use strict";const t="ui";window.BloxMania&&window.BloxMania.bundles&&(window.BloxMania.bundles[t]={version:"1.0.0",loaded:!0,timestamp:Date.now()});class e extends HTMLElement{constructor(){super(),this.notification=null,this.closeButton=null,this.isOpen=!1,this.hideTimeout=null,this.focusTrap=null}connectedCallback(){this.notification=this.querySelector(".cart-notification")||this,this.closeButton=this.querySelector(".cart-notification__close"),this.setupEventListeners(),this.setupAccessibility(),document.addEventListener("cart:item-added",this.handleCartItemAdded.bind(this)),document.addEventListener("cart:updated",this.handleCartUpdated.bind(this))}disconnectedCallback(){this.cleanup()}setupEventListeners(){this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("click",this.handleBackdropClick.bind(this))}setupAccessibility(){this.setAttribute("role","status"),this.setAttribute("aria-live","polite"),this.setAttribute("aria-atomic","true"),this.closeButton&&this.closeButton.setAttribute("aria-label","Close notification")}handleKeydown(t){"Escape"===t.key&&this.isOpen&&this.close()}handleBackdropClick(t){t.target===this&&this.isOpen&&this.close()}handleCartItemAdded(t){const{item:e,cart:s}=t.detail;this.showAddedNotification(e,s)}handleCartUpdated(t){const{cart:e}=t.detail;this.showUpdatedNotification(e)}showAddedNotification(t,e){const s=this.buildAddedContent(t,e);this.show(s,"success")}showUpdatedNotification(t){const e=this.buildUpdatedContent(t);this.show(e,"info")}buildAddedContent(t,e){const s=t.featured_image?`<img src="${t.featured_image.url}" alt="${t.product_title}" class="cart-notification__image" loading="lazy">`:"";return`\n      <div class="cart-notification__content cart-notification__content--added">\n        <div class="cart-notification__header">\n          <h3 class="cart-notification__title">Item added to cart</h3>\n          ${this.closeButton?"":'<button class="cart-notification__close" aria-label="Close notification">&times;</button>'}\n        </div>\n        <div class="cart-notification__body">\n          <div class="cart-notification__item">\n            ${s}\n            <div class="cart-notification__item-details">\n              <h4 class="cart-notification__item-title">${t.product_title}</h4>\n              ${t.variant_title?`<p class="cart-notification__item-variant">${t.variant_title}</p>`:""}\n              <p class="cart-notification__item-price">\n                ${this.formatPrice(t.final_price)} × ${t.quantity}\n              </p>\n            </div>\n          </div>\n        </div>\n        <div class="cart-notification__footer">\n          <div class="cart-notification__cart-info">\n            <p class="cart-notification__cart-total">\n              Cart total: ${this.formatPrice(e.total_price)} (${e.item_count} ${1===e.item_count?"item":"items"})\n            </p>\n          </div>\n          <div class="cart-notification__actions">\n            <button class="cart-notification__continue btn-secondary" onclick="this.closest('cart-notification').close()">\n              Continue shopping\n            </button>\n            <a href="/cart" class="cart-notification__view-cart btn-primary">\n              View cart\n            </a>\n          </div>\n        </div>\n      </div>\n    `}buildUpdatedContent(t){return`\n      <div class="cart-notification__content cart-notification__content--updated">\n        <div class="cart-notification__header">\n          <h3 class="cart-notification__title">Cart updated</h3>\n          ${this.closeButton?"":'<button class="cart-notification__close" aria-label="Close notification">&times;</button>'}\n        </div>\n        <div class="cart-notification__body">\n          <p class="cart-notification__cart-total">\n            Cart total: ${this.formatPrice(t.total_price)} (${t.item_count} ${1===t.item_count?"item":"items"})\n          </p>\n        </div>\n        <div class="cart-notification__footer">\n          <div class="cart-notification__actions">\n            <button class="cart-notification__continue btn-secondary" onclick="this.closest('cart-notification').close()">\n              Continue shopping\n            </button>\n            <a href="/cart" class="cart-notification__view-cart btn-primary">\n              View cart\n            </a>\n          </div>\n        </div>\n      </div>\n    `}show(t,e="info",s=5e3){this.innerHTML=t,this.closeButton=this.querySelector(".cart-notification__close"),this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.className=`cart-notification cart-notification--${e}`,this.open(),s>0&&(this.hideTimeout=setTimeout(()=>{this.close()},s)),this.announceToScreenReader("success"===e?"Item added to cart":"Cart updated")}open(){this.isOpen||(this.isOpen=!0,this.classList.add("cart-notification--open"),this.style.transform="translateX(100%)",this.style.transition="transform 0.3s ease-out",this.offsetHeight,this.style.transform="translateX(0)",this.setupFocusTrap(),this.dispatchEvent(new CustomEvent("cart-notification:opened",{bubbles:!0,detail:{notification:this}})))}close(){this.isOpen&&(this.isOpen=!1,this.classList.remove("cart-notification--open"),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this.style.transform="translateX(100%)",setTimeout(()=>{this.style.transform="",this.style.transition="",this.innerHTML=""},300),this.removeFocusTrap(),this.dispatchEvent(new CustomEvent("cart-notification:closed",{bubbles:!0,detail:{notification:this}})))}setupFocusTrap(){this.isKeyboardUser()&&window.DOMUtils&&(this.focusTrap=window.DOMUtils.trapFocus(this))}removeFocusTrap(){this.focusTrap&&"function"==typeof this.focusTrap&&(this.focusTrap(),this.focusTrap=null)}isKeyboardUser(){return document.body.classList.contains("keyboard-user")||document.activeElement&&document.activeElement!==document.body}announceToScreenReader(t){if(window.ThemeUtilities){const e=window.ThemeUtilities.getUtility("a11y");e&&e.announce(t)}}formatPrice(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t/100)}cleanup(){this.hideTimeout&&clearTimeout(this.hideTimeout),this.removeFocusTrap(),document.removeEventListener("cart:item-added",this.handleCartItemAdded.bind(this)),document.removeEventListener("cart:updated",this.handleCartUpdated.bind(this))}toggle(){this.isOpen?this.close():this.open()}get opened(){return this.isOpen}}customElements.get("cart-notification")||customElements.define("cart-notification",e),window.CartNotification=e;class s extends HTMLElement{constructor(){super(),this.input=null,this.decreaseButton=null,this.increaseButton=null,this.min=1,this.max=null,this.step=1}connectedCallback(){this.setupDOM(),this.setupEventListeners(),this.setupAccessibility(),this.updateButtonStates()}disconnectedCallback(){this.cleanup()}setupDOM(){this.input=this.querySelector('input[type="number"]'),this.decreaseButton=this.querySelector('.quantity-decrease, [data-action="decrease"], [name="minus"], .quantity__button[name="minus"]'),this.increaseButton=this.querySelector('.quantity-increase, [data-action="increase"], [name="plus"], .quantity__button[name="plus"]'),this.min=parseInt(this.input?.getAttribute("min")||this.getAttribute("min")||"1"),this.max=parseInt(this.input?.getAttribute("max")||this.getAttribute("max"))||null,this.step=parseInt(this.input?.getAttribute("step")||this.getAttribute("step")||"1"),this.input&&(this.input.setAttribute("min",this.min.toString()),this.max&&this.input.setAttribute("max",this.max.toString()),this.input.setAttribute("step",this.step.toString()))}setupEventListeners(){this.input&&(this.input.addEventListener("input",this.handleInput.bind(this)),this.input.addEventListener("change",this.handleChange.bind(this)),this.input.addEventListener("blur",this.handleBlur.bind(this)),this.input.addEventListener("keydown",this.handleKeydown.bind(this))),this.decreaseButton&&this.decreaseButton.addEventListener("click",this.handleDecrease.bind(this)),this.increaseButton&&this.increaseButton.addEventListener("click",this.handleIncrease.bind(this))}setupAccessibility(){if(this.input&&(this.input.setAttribute("role","spinbutton"),this.input.setAttribute("aria-label","Quantity")),this.decreaseButton&&(this.decreaseButton.setAttribute("aria-label","Decrease quantity"),this.decreaseButton.setAttribute("type","button")),this.increaseButton&&(this.increaseButton.setAttribute("aria-label","Increase quantity"),this.increaseButton.setAttribute("type","button")),!this.querySelector("[aria-live]")){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="visually-hidden",t.id=`quantity-live-${Math.random().toString(36).substr(2,9)}`,this.appendChild(t)}}handleInput(t){const e=parseInt(t.target.value);isNaN(e)||e<this.min?this.input.classList.add("quantity-input--invalid"):this.input.classList.remove("quantity-input--invalid"),this.updateButtonStates()}handleChange(t){this.validateAndUpdate()}handleBlur(t){this.validateAndUpdate()}handleKeydown(t){switch(t.key){case"ArrowUp":t.preventDefault(),this.changeQuantity(this.step);break;case"ArrowDown":t.preventDefault(),this.changeQuantity(-this.step);break;case"Enter":t.preventDefault(),this.validateAndUpdate()}}handleDecrease(t){t.preventDefault(),this.changeQuantity(-this.step)}handleIncrease(t){t.preventDefault(),this.changeQuantity(this.step)}changeQuantity(t){const e=(parseInt(this.input.value)||this.min)+t;this.setValue(e)}setValue(t){const e=this.validateValue(t);this.input.value!==e.toString()&&(this.input.value=e,this.input.dispatchEvent(new Event("change",{bubbles:!0})),this.dispatchEvent(new CustomEvent("quantity:changed",{bubbles:!0,detail:{value:e,previousValue:parseInt(this.input.dataset.previousValue)||this.min,input:this}})),this.input.dataset.previousValue=e.toString(),this.announceQuantityChange(e)),this.updateButtonStates()}validateValue(t){const e=parseInt(t);if(isNaN(e))return this.min;if(e<this.min)return this.min;if(this.max&&e>this.max)return this.max;const s=(e-this.min)%this.step;return 0!==s?e-s:e}validateAndUpdate(){const t=parseInt(this.input.value),e=this.validateValue(t);t!==e&&this.setValue(e)}updateButtonStates(){const t=parseInt(this.input.value)||this.min;if(this.decreaseButton){const e=t>this.min;this.decreaseButton.disabled=!e,this.decreaseButton.setAttribute("aria-disabled",!e)}if(this.increaseButton){const e=!this.max||t<this.max;this.increaseButton.disabled=!e,this.increaseButton.setAttribute("aria-disabled",!e)}}announceQuantityChange(t){const e=this.querySelector("[aria-live]");e&&(e.textContent=`Quantity changed to ${t}`)}cleanup(){}get value(){return parseInt(this.input?.value)||this.min}set value(t){this.setValue(t)}get minimum(){return this.min}set minimum(t){this.min=parseInt(t),this.input&&this.input.setAttribute("min",this.min.toString()),this.validateAndUpdate()}get maximum(){return this.max}set maximum(t){this.max=parseInt(t),this.input&&(this.max?this.input.setAttribute("max",this.max.toString()):this.input.removeAttribute("max")),this.validateAndUpdate()}increase(){this.changeQuantity(this.step)}decrease(){this.changeQuantity(-this.step)}reset(){this.setValue(this.min)}}if(customElements.get("quantity-input")||customElements.define("quantity-input",s),"undefined"==typeof HeaderDrawer){class t extends HTMLElement{constructor(){super(),this.header=null,this.drawer=null,this.menuButton=null,this.closeButton=null,this.isOpen=!1}connectedCallback(){this.header=this.querySelector(".header"),this.drawer=this.querySelector(".mobile-menu"),this.menuButton=this.querySelector(".mobile-menu-toggle"),this.closeButton=this.querySelector("#mobile-menu-close"),this.bindEvents(),this.setupScrollEffects()}bindEvents(){this.menuButton?.addEventListener("click",()=>this.openDrawer()),this.closeButton?.addEventListener("click",()=>this.closeDrawer()),document.addEventListener("keydown",t=>{"Escape"===t.key&&this.isOpen&&this.closeDrawer()}),this.addEventListener("click",t=>{t.target===this&&this.isOpen&&this.closeDrawer()})}setupScrollEffects(){let t=0;const e=e=>{if(!this.header)return;const s=Math.min(e/300,1);this.header.style.setProperty("--scroll-progress",s),e>100?(this.header.classList.add("header--dynamic"),this.header.classList.remove("header--transparent")):(this.header.classList.remove("header--dynamic"),this.header.classList.add("header--transparent")),e>t&&e>100?this.header.classList.add("header--hidden"):this.header.classList.remove("header--hidden")};window.addEventListener("scroll",()=>{const s=window.pageYOffset||document.documentElement.scrollTop;e(s),t=s}),this.header.classList.add("header--transparent"),this.header.classList.remove("header--dynamic"),this.header.classList.remove("header--hidden"),this.header.style.setProperty("--scroll-progress","0")}openDrawer(){this.isOpen=!0,this.setAttribute("open",""),document.body.classList.add("header-drawer-open"),this.closeButton?.focus(),this.trapFocus()}closeDrawer(){this.isOpen=!1,this.removeAttribute("open"),document.body.classList.remove("header-drawer-open"),this.menuButton?.focus(),this.removeTrapFocus()}trapFocus(){const t=this.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(0===t.length)return;const e=t[0],s=t[t.length-1];this.addEventListener("keydown",t=>{"Tab"===t.key&&(t.shiftKey?document.activeElement===e&&(t.preventDefault(),s.focus()):document.activeElement===s&&(t.preventDefault(),e.focus()))})}removeTrapFocus(){this.removeEventListener("keydown",this.trapFocus)}}customElements.get("header-drawer")||customElements.define("header-drawer",t),window.HeaderDrawer=t}class i extends HTMLElement{constructor(){super(),this.detailsContainer=null,this.summaryToggle=null,this.closeButton=null,this.focusTrap=null,this.isOpen=!1}connectedCallback(){this.setupDOM(),this.setupEventListeners(),this.setupAccessibility()}disconnectedCallback(){this.cleanup()}setupDOM(){this.detailsContainer=this.querySelector("details")||this.closest("details"),this.summaryToggle=this.querySelector("summary"),this.closeButton=this.querySelector(".modal-close-button"),this.detailsContainer||(this.detailsContainer=document.createElement("details"),this.parentNode.insertBefore(this.detailsContainer,this),this.detailsContainer.appendChild(this))}setupEventListeners(){this.summaryToggle&&this.summaryToggle.addEventListener("click",this.handleSummaryClick.bind(this)),this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.detailsContainer&&this.detailsContainer.addEventListener("toggle",this.handleToggle.bind(this)),this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("click",this.handleBackdropClick.bind(this)),document.addEventListener("modal:opened",this.handleModalOpened.bind(this)),document.addEventListener("modal:closed",this.handleModalClosed.bind(this))}setupAccessibility(){if(this.setAttribute("role","dialog"),this.setAttribute("aria-modal","true"),this.summaryToggle&&(this.summaryToggle.setAttribute("aria-expanded","false"),this.summaryToggle.setAttribute("aria-haspopup","dialog")),!this.getAttribute("aria-labelledby")){const t=this.querySelector(".modal-title, h1, h2, h3");t&&(t.id||(t.id=`modal-title-${Math.random().toString(36).substr(2,9)}`),this.setAttribute("aria-labelledby",t.id))}}handleSummaryClick(t){t.preventDefault(),this.detailsContainer.hasAttribute("open")?this.close():this.open()}handleToggle(t){this.detailsContainer.hasAttribute("open")?this.handleOpen():this.handleClose()}handleKeydown(t){if(this.isOpen&&"Escape"===t.key)t.preventDefault(),this.close()}handleBackdropClick(t){t.target===this&&this.isOpen&&this.close()}handleModalOpened(t){t.detail.modal===this&&(document.body.style.overflow="hidden")}handleModalClosed(t){t.detail.modal===this&&(document.body.style.overflow="")}open(){this.isOpen||(this.detailsContainer.setAttribute("open",""),this.handleOpen())}handleOpen(){this.isOpen=!0,this.classList.add("modal--open"),this.summaryToggle&&this.summaryToggle.setAttribute("aria-expanded","true"),this.setupFocusTrap(),document.body.classList.add("modal-open"),document.dispatchEvent(new CustomEvent("modal:opened",{detail:{modal:this}})),this.dispatchEvent(new CustomEvent("details-modal:opened",{bubbles:!0,detail:{modal:this}}))}close(){this.isOpen&&(this.detailsContainer.removeAttribute("open"),this.handleClose())}handleClose(){this.isOpen=!1,this.classList.remove("modal--open"),this.summaryToggle&&this.summaryToggle.setAttribute("aria-expanded","false"),this.removeFocusTrap(),document.body.classList.remove("modal-open"),this.summaryToggle&&this.summaryToggle.focus(),document.dispatchEvent(new CustomEvent("modal:closed",{detail:{modal:this}})),this.dispatchEvent(new CustomEvent("details-modal:closed",{bubbles:!0,detail:{modal:this}}))}setupFocusTrap(){if(window.DOMUtils){const t=this.querySelector('input, button, select, textarea, a[href], [tabindex]:not([tabindex="-1"])')||this.closeButton;this.focusTrap=window.DOMUtils.trapFocus(this,t)}else{const t=this.querySelector('input, button, select, textarea, a[href], [tabindex]:not([tabindex="-1"])');t&&t.focus()}}removeFocusTrap(){this.focusTrap&&"function"==typeof this.focusTrap&&(this.focusTrap(),this.focusTrap=null)}cleanup(){this.removeFocusTrap(),this.isOpen&&(document.body.classList.remove("modal-open"),document.body.style.overflow=""),document.removeEventListener("modal:opened",this.handleModalOpened.bind(this)),document.removeEventListener("modal:closed",this.handleModalClosed.bind(this))}toggle(){this.isOpen?this.close():this.open()}get opened(){return this.isOpen}show(){this.open()}hide(){this.close()}}customElements.get("details-modal")||customElements.define("details-modal",i),window.DetailsModal=i;class n extends HTMLElement{constructor(){super(),this.input=null,this.results=null,this.closeButton=null,this.focusTrap=null,this.isOpen=!1,this.searchTimeout=null,this.searchUtils=null}connectedCallback(){this.input=this.querySelector('input[type="search"]'),this.results=this.querySelector(".search-results"),this.closeButton=this.querySelector(".search-modal__close"),this.setupSearch(),this.setupAccessibility(),this.setupEventListeners(),window.SearchUtils&&(this.searchUtils=new window.SearchUtils)}disconnectedCallback(){this.cleanup()}setupSearch(){this.input&&(this.searchHandler=window.DOMUtils?window.DOMUtils.debounce(this.performSearch.bind(this),300):this.debounceSearch(this.performSearch.bind(this),300),this.input.addEventListener("input",this.searchHandler),this.input.addEventListener("focus",this.handleInputFocus.bind(this)))}setupAccessibility(){this.input&&(this.input.setAttribute("aria-expanded","false"),this.input.setAttribute("aria-haspopup","listbox"),this.input.setAttribute("aria-autocomplete","list"),this.input.setAttribute("role","combobox")),this.results&&(this.results.setAttribute("role","listbox"),this.results.setAttribute("aria-label","Search results")),this.setAttribute("role","dialog"),this.setAttribute("aria-modal","true"),this.setAttribute("aria-labelledby","search-modal-title")}setupEventListeners(){this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.addEventListener("keydown",this.handleKeydown.bind(this)),this.addEventListener("click",this.handleBackdropClick.bind(this)),this.results&&this.results.addEventListener("click",this.handleResultClick.bind(this))}handleInputFocus(){!this.isOpen&&this.input.value.trim().length>0&&this.performSearch()}handleKeydown(t){switch(t.key){case"Escape":this.close();break;case"ArrowDown":t.preventDefault(),this.navigateResults("down");break;case"ArrowUp":t.preventDefault(),this.navigateResults("up");break;case"Enter":t.preventDefault(),this.selectCurrentResult()}}handleBackdropClick(t){t.target===this&&this.close()}handleResultClick(t){const e=t.target.closest("[data-search-result]");if(e){const t=e.dataset.url||e.querySelector("a")?.href;t&&(window.location.href=t)}}async performSearch(){const t=this.input?.value?.trim();if(!t||t.length<2)this.hideResults();else{this.showLoadingState();try{let e;e=this.searchUtils?await this.searchUtils.performSearch(t,{limit:8,resources:["product","collection","page"]}):await this.basicSearch(t),e&&(this.displayResults(e),this.open())}catch(t){console.error("Search error:",t),this.showErrorState()}}}async basicSearch(t){try{const e=await fetch(`/search/suggest.json?q=${encodeURIComponent(t)}&resources[type]=product&resources[limit]=8`);if(!e.ok)throw new Error(`Search failed: ${e.status}`);const s=await e.json();return console.log("Search API response:",s),this.parseJsonResults(s,t)}catch(t){throw console.error("Search API error:",t),t}}parseJsonResults(t,e){console.log("Full response data:",t);const s=[];if(t.resources&&t.resources.results)if(Array.isArray(t.resources.results))s.push(...t.resources.results);else if("object"==typeof t.resources.results){const e=t.resources.results;Object.keys(e).forEach(t=>{Array.isArray(e[t])&&s.push(...e[t])})}return t.resources&&t.resources.products&&Array.isArray(t.resources.products)&&s.push(...t.resources.products),t.results&&Array.isArray(t.results)&&s.push(...t.results),console.log("Parsed products:",s),s.map(t=>{if(!t||!t.title)return console.log("Skipping invalid product:",t),null;let e="";if("string"==typeof t.url)e=t.url;else if(t.handle)e=`/products/${t.handle}`;else{if(!t.id)return console.log("No valid URL for product:",t),null;e=`/products/${t.id}`}return{title:t.title||t.name||"",url:e,handle:t.handle||"",id:t.id||"",image:t.image||t.featured_image||"",price:t.price||t.price_min||"",compare_at_price:t.compare_at_price||t.price_max||"",available:!1!==t.available,type:"product"}}).filter(Boolean)}displayResults(t){if(!this.results)return;let e="";t.products&&t.products.length>0&&(e+='<div class="search-results__section">',e+='<h3 class="search-results__heading">Products</h3>',e+='<ul class="search-results__list" role="listbox">',t.products.forEach((s,i)=>{e+=`\n          <li class="search-results__item" role="option" data-search-result data-url="${s.url}" tabindex="-1">\n            <a href="${s.url}" class="search-results__link">\n              ${s.image?`<img src="${s.image}" alt="${s.title}" class="search-results__image" loading="lazy">`:""}\n              <div class="search-results__content">\n                <h4 class="search-results__title">${this.highlightQuery(s.title,t.query)}</h4>\n                ${s.price?`<span class="search-results__price">${s.price}</span>`:""}\n              </div>\n            </a>\n          </li>\n        `}),e+="</ul></div>"),t.collections&&t.collections.length>0&&(e+='<div class="search-results__section">',e+='<h3 class="search-results__heading">Collections</h3>',e+='<ul class="search-results__list" role="listbox">',t.collections.forEach(s=>{e+=`\n          <li class="search-results__item" role="option" data-search-result data-url="${s.url}" tabindex="-1">\n            <a href="${s.url}" class="search-results__link">\n              ${s.image?`<img src="${s.image}" alt="${s.title}" class="search-results__image" loading="lazy">`:""}\n              <div class="search-results__content">\n                <h4 class="search-results__title">${this.highlightQuery(s.title,t.query)}</h4>\n              </div>\n            </a>\n          </li>\n        `}),e+="</ul></div>"),""===e&&(e='<div class="search-results__empty">No results found</div>'),this.results.innerHTML=e,this.updateAccessibilityAttributes()}highlightQuery(t,e){if(!t||!e)return t;if(window.SearchUtils&&window.SearchUtils.highlightSearchTerms)return window.SearchUtils.highlightSearchTerms(t,e);const s=new RegExp(`(${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return t.replace(s,"<mark>$1</mark>")}showLoadingState(){this.results&&(this.results.innerHTML='<div class="search-results__loading">Searching...</div>')}showErrorState(){this.results&&(this.results.innerHTML='<div class="search-results__error">Search failed. Please try again.</div>')}hideResults(){this.results&&(this.results.innerHTML=""),this.close()}updateAccessibilityAttributes(){const t=this.results?.querySelectorAll(".search-results__item");t&&t.forEach((t,e)=>{t.setAttribute("id",`search-result-${e}`)}),this.input&&this.input.setAttribute("aria-expanded",this.isOpen?"true":"false")}navigateResults(t){const e=this.results?.querySelectorAll(".search-results__item");if(!e||0===e.length)return;const s=Array.from(e).findIndex(t=>t.classList.contains("search-results__item--focused"));let i;i="down"===t?s<e.length-1?s+1:0:s>0?s-1:e.length-1,e.forEach(t=>t.classList.remove("search-results__item--focused")),e[i].classList.add("search-results__item--focused"),e[i].focus()}selectCurrentResult(){const t=this.results?.querySelector(".search-results__item--focused");if(t){const e=t.querySelector("a");e&&e.click()}}open(){this.isOpen||(this.isOpen=!0,this.classList.add("search-modal--open"),document.body.style.overflow="hidden",this.setupFocusTrap(),this.dispatchEvent(new CustomEvent("search-modal:opened",{bubbles:!0,detail:{modal:this}})))}close(){if(!this.isOpen)return;this.isOpen=!1,this.classList.remove("search-modal--open"),document.body.style.overflow="",this.removeFocusTrap(),this.results&&(this.results.innerHTML="");const t=document.querySelector("[data-search-trigger]");t&&t.focus(),this.dispatchEvent(new CustomEvent("search-modal:closed",{bubbles:!0,detail:{modal:this}}))}setupFocusTrap(){window.DOMUtils?this.focusTrap=window.DOMUtils.trapFocus(this,this.input):this.input&&this.input.focus()}removeFocusTrap(){this.focusTrap&&"function"==typeof this.focusTrap&&(this.focusTrap(),this.focusTrap=null)}debounceSearch(t,e){return(...s)=>{clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>t.apply(this,s),e)}}cleanup(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.removeFocusTrap(),this.isOpen&&(document.body.style.overflow="")}toggle(){this.isOpen?this.close():this.open()}get opened(){return this.isOpen}}customElements.get("search-modal")||customElements.define("search-modal",n),window.SearchModal=n,window.BloxMania&&window.BloxMania.bundles&&window.BloxMania.bundles[t]&&(window.BloxMania.bundles[t].initialized=!0),console.log(`✅ ${t} bundle loaded`)}();